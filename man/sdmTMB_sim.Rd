% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/sim.R
\name{sdmTMB_sim}
\alias{sdmTMB_sim}
\title{Simulate from a spatial/spatiotemporal model}
\usage{
sdmTMB_sim(
  mesh,
  x,
  y,
  range,
  time_steps = 1L,
  X = NULL,
  betas = NULL,
  family = gaussian(link = "identity"),
  rho = 0,
  sigma_O = 0.1,
  sigma_E = 0,
  sigma_V = rep(0, length(betas)),
  phi = 0.01,
  thetaf = 1.5,
  df = 3,
  seed = sample.int(1e+06, 1),
  list = FALSE
)
}
\arguments{
\item{mesh}{Output from \code{\link[=make_mesh]{make_mesh()}} or a mesh directly from INLA.}

\item{x}{A vector of x coordinates. Should match \code{mesh}.}

\item{y}{A vector of y coordinates. Should match \code{mesh}.}

\item{range}{Parameter that controls the decay of spatial correlation.}

\item{time_steps}{The number of time steps.}

\item{X}{An optional covariate design matrix formatted as a list with each
element of the list representing a slice in time. If ommitted and \code{betas}
is not \code{NULL}, will be set to standard normal.}

\item{betas}{A vector of beta values (design-matrix fixed-effect coefficient
values). If a random walk (\code{sigma_V > 0}), these are the starting values.}

\item{family}{Family as in \code{\link[=sdmTMB]{sdmTMB()}}.}

\item{rho}{Spatiotemporal correlation between years;
should be between -1 and 1.}

\item{sigma_O}{SD of spatial process (Omega).}

\item{sigma_E}{SD of spatiotemporal process (Epsilon).}

\item{sigma_V}{A vector of standard deviations of time-varying random walk on
parameters. Set to 0 for parameters that should not vary through time.}

\item{phi}{Observation error scale parameter.}

\item{thetaf}{Tweedie p (power) parameter; between 1 and 2.}

\item{df}{Student-t degrees of freedom.}

\item{seed}{A value with which to set the random seed.}

\item{list}{Logical for whether output is in list format. If \code{TRUE},
data is in list element 1 and input values in element 2.}
}
\value{
A data frame where:
\itemize{
\item \code{omega_s} represents the simulated spatial random effects.
\item \code{epsilon_st} represents the simulated spatiotemporal random effects.
\item \code{eta} is the true value in link space
\item \code{mu} is the true value in inverse link space.
\item \code{observed} represents the simulated process with observation error.
\item \code{b_...} contain the beta values for each covariate used to simulate each time slice.
\item \code{cov_...} covariate values for each observation.
}
}
\description{
Simulate from a spatial/spatiotemporal model
}
\examples{
\donttest{
set.seed(42)
x <- runif(50, -1, 1)
y <- runif(50, -1, 1)
N <- length(x)
time_steps <- 6
X <- model.matrix(~ x1, data.frame(x1 = rnorm(N * time_steps)))
loc <- data.frame(x = x, y = y)
mesh <- make_mesh(loc, xy_cols = c("x", "y"), cutoff = 0.1)
s <- sdmTMB_sim(
  x = x, y = y, mesh = mesh, X = X,
  betas = c(0.5, 0.7), time_steps = time_steps, rho = 0.5,
  phi = 0.2, range = 0.8, sigma_O = 0, sigma_E = 0.3,
  seed = 123, family = gaussian()
)

mesh <- make_mesh(s, xy_cols = c("x", "y"), cutoff = 0.1)
m <- sdmTMB(
  data = s, formula = observed ~ x1,
  time = "time", spde = mesh,
  ar1_fields = TRUE, include_spatial = FALSE
)
tidy(m, conf.int = TRUE)
tidy(m, "ran_pars", conf.int = TRUE)
}
}
